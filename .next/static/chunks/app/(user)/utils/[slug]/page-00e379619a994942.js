(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[650],{53473:function(e,t,n){Promise.resolve().then(n.t.bind(n,78139,23)),Promise.resolve().then(n.bind(n,39818))},24197:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var a=n(57437),r=n(53975),s=n(49804),i=n(2265);let l=e=>{let{message:t,onExited:n,autoHideDuration:l,...o}=e,[d,c]=i.useState(!0);return(0,a.jsx)(r.Z,{open:d,onClose:(e,t)=>{"clickaway"!==t&&c(!1)},TransitionProps:{onExited:n},anchorOrigin:{vertical:"top",horizontal:"right"},autoHideDuration:null!=l?l:3e3,...o,children:(0,a.jsx)(s.Z,{severity:t.severity,children:t.message})},t.key)}},27392:function(e,t,n){"use strict";n.d(t,{pm:function(){return a.useToast}}),n(24197);var a=n(73534)},73534:function(e,t,n){"use strict";n.r(t),n.d(t,{ToastContext:function(){return i},ToastProvider:function(){return l},useToast:function(){return o}});var a=n(57437),r=n(2265),s=n(24197);let i=(0,r.createContext)(null),l=e=>{let{children:t,...n}=e,[l,o]=(0,r.useState)([]),d=e=>o(t=>t.filter(t=>t.key!==e));return(0,a.jsxs)(i.Provider,{value:{addMessage(e){o(t=>[...t,e])}},children:[t,l.map(e=>(0,a.jsx)(s.F,{message:e,onExited:()=>d(e.key),...n},e.key))]})},o=()=>{let{addMessage:e}=(0,r.useContext)(i),t=(t,n)=>{e({message:t,...n,key:new Date().getTime()})};return{show:t,info(e){t(e,{severity:"info"})},success(e){t(e,{severity:"success"})},warning(e){t(e,{severity:"warning"})},error(e){t(e,{severity:"error"})}}}},39818:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var a=n(57437),r=n(39227),s=n(19643),i=n(92277),l=n(2265),o=n(61396),d=n.n(o),c=n(46986),u=n(49605),x=n(67722),h=e=>{var t,n,s;let{song:i}=e;return(0,a.jsxs)(r.Z,{sx:{display:"flex",mb:2,alignItems:"center",mt:2},children:[(0,a.jsx)(r.Z,{sx:{position:"relative",mr:2},children:(0,a.jsx)(d(),{href:"/track/".concat(i._id,"?audio=").concat(i.audio,"&id=").concat(i._id),children:(0,a.jsx)("img",{src:"".concat("http://160.25.81.159:8000","/image/song/").concat(i.cover),alt:"",width:60,height:60,style:{borderRadius:4}})})}),(0,a.jsxs)(r.Z,{sx:{flexGrow:1,a:{textDecoration:"unset",color:"unset"}},children:[(0,a.jsx)(d(),{href:"/track/".concat(i._id,"?audio=").concat(i.audio,"&id=").concat(i._id),children:i.name}),(0,a.jsx)(r.Z,{sx:{fontSize:12},children:null==i?void 0:i.users.map(e=>(0,a.jsxs)(d(),{href:"/detail/".concat(e._id),children:[e.name," "]}))}),(0,a.jsxs)(r.Z,{sx:{display:"flex",gap:1,mt:.5,alignItems:"center",fontSize:"12px",color:"#888"},children:[(0,a.jsx)(c.default,{fontSize:"inherit"})," ",(null==i?void 0:null===(t=i.like)||void 0===t?void 0:t.length)||0,(0,a.jsx)(x.default,{fontSize:"small"})," ",(null==i?void 0:null===(n=i.dislike)||void 0===n?void 0:n.length)||0,(0,a.jsx)(u.default,{fontSize:"inherit"})," ",(null==i?void 0:null===(s=i.totalListen)||void 0===s?void 0:s.length)||0]})]})]},i._id)},p=n(81835),v=n(82749),m=n(86869);n(33724);var f=()=>{var e;let{data:t}=(0,v.useSession)(),[n,s]=(0,l.useState)([]),i=(0,l.useRef)([]);(0,l.useEffect)(()=>{let e=async()=>{try{var e;let n=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/playlists"),method:"GET",headers:{Authorization:"Bearer ".concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.access_token)}});(null==n?void 0:n.data)&&s(null==n?void 0:n.data)}catch(e){console.log(e)}};e()},[null==t?void 0:null===(e=t.user)||void 0===e?void 0:e._id]);let o=e=>{i.current.forEach((t,n)=>{t&&n!==e&&t.pause()})};return(0,a.jsx)(a.Fragment,{children:null==n?void 0:n.map((e,t)=>{let n=e.songID[0];return(0,a.jsxs)(r.Z,{sx:{display:"flex",border:"2px dashed",color:"black",borderRadius:"5px",justifyContent:"space-around",alignContent:"center",marginBottom:3,padding:2,gap:5},children:[(0,a.jsx)(m.Z,{src:"".concat("http://160.25.81.159:8000","/audio/").concat(n.audio),volume:.5,style:{padding:0,flex:7,background:"white",boxShadow:"unset"},ref:e=>{e&&(i.current[t]=e.audio.current)},onPlay:()=>{o(t)}}),(0,a.jsx)(r.Z,{sx:{flex:3},children:(0,a.jsx)(h,{song:n})})]},e._id)})})},j=()=>{var e;let{data:t}=(0,v.useSession)(),[n,s]=(0,l.useState)([]),i=(0,l.useRef)([]);(0,l.useEffect)(()=>{let e=async()=>{try{var e,n;let a=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/historys/user/").concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e._id),method:"GET",headers:{Authorization:"Bearer ".concat(null==t?void 0:null===(n=t.user)||void 0===n?void 0:n.access_token)}});(null==a?void 0:a.data)&&s(null==a?void 0:a.data)}catch(e){console.log(e)}};e()},[null==t?void 0:null===(e=t.user)||void 0===e?void 0:e._id]);let o=e=>{let{index:t,start:n}=e;i.current.forEach((e,n)=>{e&&n!==t&&e.pause()})};return(0,a.jsx)(a.Fragment,{children:null==n?void 0:n.map((e,t)=>{let n=e.songID[0];return(0,a.jsxs)(r.Z,{sx:{display:"flex",border:"2px dashed",color:"black",borderRadius:"5px",justifyContent:"space-around",alignContent:"center",marginBottom:3,padding:2,gap:5},children:[(0,a.jsx)(m.Z,{src:"".concat("http://160.25.81.159:8000","/audio/").concat(n.audio),volume:.5,style:{padding:0,flex:7,background:"white",boxShadow:"unset"},ref:n=>{if(n){i.current[t]=n.audio.current;let a=i.current[t];a&&(a.currentTime=e.start)}},onPlay:()=>{o({index:t,start:e.start})}}),(0,a.jsx)(r.Z,{sx:{flex:3},children:(0,a.jsx)(h,{song:n})})]},e._id)})})},g=n(35551),b=n(43226),y=n(21975),Z=n(84081),w=n(50819),k=n(54997),S=n(12339),_=n(35843),C=n(83686),T=n(33533),z=n(29222),D=n(27392),I=n(24033);let E=(0,_.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),R=[{id:"686e76717c55361f30426d66",name:"Mỹ T\xe2m"},{id:"686e76717c55361f30426d77",name:"Đen V\xe2u"},{id:"686e76717c55361f30426d88",name:"Noo Phước Thịnh"}];function P(e){let{group:t,setGroup:n}=e,{data:r}=(0,v.useSession)(),s=async e=>{var a,s,i;let l=null===(a=e.target.files)||void 0===a?void 0:a[0];if(l)try{let e=new FormData;e.append("file",l);let a=await z.Z.post("".concat("http://160.25.81.159:8000/api/v1","/files/upload/image"),e,{headers:{Authorization:"Bearer ".concat(null==r?void 0:r.user.access_token),"Content-Type":"multipart/form-data",folder_type:"group",type:"image"}});(null==a?void 0:a.data)&&n({...t,avatar:null==a?void 0:null===(i=a.data)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:s.fileName})}catch(e){console.error("Upload failed",e)}};return(0,a.jsxs)(g.Z,{component:"label",variant:"contained",sx:{background:"black",mb:2},startIcon:(0,a.jsx)(C.Z,{}),children:["Upload ảnh group",(0,a.jsx)(E,{type:"file",accept:"image/*",onChange:s})]})}var G=e=>{let{setTab:t}=e,[n,s]=(0,l.useState)({name:"",avatar:"",members:[]}),i=(0,D.pm)(),{data:o}=(0,v.useSession)();(0,I.useRouter)();let d=async()=>{let e=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/groups"),method:"POST",headers:{Authorization:"Bearer ".concat(null==o?void 0:o.user.access_token)},body:n});(null==e?void 0:e.statusCode)===201?(i.success(e.message),t(4)):i.error(e.message)},c=e=>{n.members.includes(e)||s(t=>({...t,members:[...t.members,e]}))},u=e=>{s(t=>({...t,members:t.members.filter(t=>t!==e)}))};return(0,a.jsxs)(r.Z,{sx:{border:"2px dashed",p:4,borderRadius:2},children:[(0,a.jsx)(b.Z,{variant:"h5",mb:3,children:"Tạo nh\xf3m người d\xf9ng"}),(0,a.jsxs)(r.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsxs)(r.Z,{sx:{flex:4,pr:2},children:[(0,a.jsx)("img",{src:"".concat("http://160.25.81.159:8000","/image/group/").concat(n.avatar),alt:"Group Avatar",style:{width:250,height:250,borderRadius:8}}),(0,a.jsx)(P,{group:n,setGroup:s})]}),(0,a.jsxs)(r.Z,{flex:6,children:[(0,a.jsx)(y.Z,{label:"T\xean group",fullWidth:!0,value:n.name,onChange:e=>s(t=>({...t,name:e.target.value})),sx:{mb:3}}),(0,a.jsx)(r.Z,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:n.members.map(e=>{let t=R.find(t=>t.id===e);return(0,a.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",px:1.5,py:.5,background:"black",color:"white",borderRadius:2},children:[(0,a.jsx)(b.Z,{variant:"body2",sx:{mr:1},children:(null==t?void 0:t.name)||e}),(0,a.jsx)(T.Z,{fontSize:"small",sx:{cursor:"pointer"},onClick:()=>u(e)})]},e)})}),(0,a.jsxs)(Z.Z,{fullWidth:!0,sx:{mt:2},children:[(0,a.jsx)(w.Z,{children:"Th\xeam th\xe0nh vi\xean"}),(0,a.jsx)(k.Z,{value:"",label:"Th\xeam th\xe0nh vi\xean",onChange:e=>c(e.target.value),children:R.map(e=>(0,a.jsx)(S.Z,{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(g.Z,{sx:{mt:4,background:"black",color:"white",borderRadius:2},onClick:d,children:"Tạo nh\xf3m"})]})]})]})},A=n(29872),B=n(98075),W=n(3283),O=n(90858),N=n(43881),F=n(89396),U=n(9609);let H={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:1e3,bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4};var L=e=>{let{open:t,setOpen:n,group:s,setData:i,dataGroup:o}=e,{data:d}=(0,v.useSession)(),[c,u]=l.useState([]),x=(0,D.pm)();l.useEffect(()=>{let e=async()=>{let e=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/users/all"),method:"GET"});(null==e?void 0:e.data)&&u(e.data)};e()},[]);let[h,m]=l.useState([]),[f,j]=l.useState(""),y=e=>{h.includes(e)||m(t=>[...t,e]),j("")},_=e=>{m(t=>t.filter(t=>t!==e))},C=async()=>{try{var e;let t=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/groups/add"),method:"PATCH",headers:{Authorization:"Bearer ".concat(null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.access_token)},body:{members:h,name:s.name,id:s.adminGroup}});(null==t?void 0:t.data)&&(i(e=>e.map(e=>e._id===t.data._id?t.data:e)),n(!1)),(null==t?void 0:t.statusCode)!==200&&x.error(null==t?void 0:t.message)}catch(e){console.log(e)}};return(0,a.jsx)(U.Z,{open:t,onClose:()=>n(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,a.jsxs)(r.Z,{sx:H,children:[(0,a.jsxs)(b.Z,{variant:"h6",mb:2,children:["Quản l\xfd th\xe0nh vi\xean nh\xf3m ",s.name]}),(0,a.jsx)(r.Z,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:h.map(e=>{let t=c.find(t=>t._id===e);return(0,a.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",px:1.5,py:.5,background:"black",color:"white",borderRadius:2},children:[(0,a.jsx)(b.Z,{variant:"body2",sx:{mr:1},children:(null==t?void 0:t.name)||e}),(0,a.jsx)(T.Z,{fontSize:"small",sx:{cursor:"pointer"},onClick:()=>_(e)})]},e)})}),(0,a.jsxs)(Z.Z,{fullWidth:!0,children:[(0,a.jsx)(w.Z,{children:"Th\xeam th\xe0nh vi\xean"}),(0,a.jsx)(k.Z,{value:f,label:"Th\xeam th\xe0nh vi\xean",onChange:e=>y(e.target.value),children:c.filter(e=>!h.includes(e._id)).map(e=>(0,a.jsx)(S.Z,{value:e._id,children:e.name},e._id))})]}),(0,a.jsx)(g.Z,{sx:{mt:3,background:"black",color:"white",borderRadius:2},onClick:C,children:"Lưu thay đổi"})]})})},M=()=>{let[e,t]=(0,l.useState)([]),[n,s]=(0,l.useState)(!1),[i,o]=(0,l.useState)(null),{data:c}=(0,v.useSession)();(0,l.useEffect)(()=>{var e;let n=async()=>{try{var e;let n=await (0,p.w)({url:"".concat("http://160.25.81.159:8000/api/v1","/groups/user"),method:"GET",headers:{Authorization:"Bearer ".concat(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.access_token)}});(null==n?void 0:n.data)&&t(n.data)}catch(e){console.log(e)}};(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.access_token)&&n()},[c]);let u=e=>{o(e)};return(0,a.jsxs)(r.Z,{sx:{p:2},children:[null==e?void 0:e.map(e=>(0,a.jsxs)(A.Z,{sx:{p:2,mb:3},children:[(0,a.jsxs)(B.Z,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[(0,a.jsx)(W.Z,{src:"".concat("http://160.25.81.159:8000","/image/group/").concat(e.avatar),alt:e.avatar}),(0,a.jsxs)(b.Z,{variant:"body2",color:"text.secondary",children:[" ",e.name]}),(0,a.jsx)(F.Z,{sx:{cursor:"pointer"},onClick:()=>u(e)})]}),(0,a.jsx)(b.Z,{variant:"subtitle1",children:"Th\xe0nh vi\xean:"}),(0,a.jsx)(r.Z,{mt:2,display:"flex",flexWrap:"wrap",gap:4,justifyContent:"flex-start",children:e.members.map(e=>{var t,n;return(0,a.jsxs)(r.Z,{display:"flex",flexDirection:"column",alignItems:"center",width:100,sx:{a:{textDecoration:"unset",color:"unset"}},children:[(0,a.jsx)(W.Z,{src:"".concat("http://160.25.81.159:8000","/image/user/").concat(e.avatar),sx:{width:100,height:100,fontSize:40}}),(0,a.jsx)(d(),{href:"/detail/".concat(e._id),children:e.name}),(null==e?void 0:null===(t=e.followers)||void 0===t?void 0:t.length)>0&&(0,a.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(N.Z,{sx:{fontSize:16}}),(0,a.jsx)(b.Z,{variant:"body2",children:null==e?void 0:null===(n=e.followers)||void 0===n?void 0:n.length})]}),(0,a.jsx)(O.Z,{title:e.name,children:(0,a.jsx)(b.Z,{mt:1,textAlign:"center",sx:{color:"white",fontSize:14,fontWeight:500,maxWidth:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name})})]},e._id)})})]},e._id)),i&&(0,a.jsx)(L,{open:!!i,setOpen:e=>!e&&o(null),group:i,setData:t,dataGroup:e})]})},J=n(81735);function Q(e){let{children:t,value:n,index:s,...i}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:n!==s,...i,children:n===s&&(0,a.jsx)(r.Z,{sx:{pt:3},children:t})})}function V(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}var q=e=>{let{tabStart:t}=e,[n,o]=(0,l.useState)(t),{data:d}=(0,v.useSession)(),c=!(null==d?void 0:d.user)||!(0,J.Zd)(d.user.role);return(0,a.jsxs)(r.Z,{children:[(0,a.jsxs)(s.Z,{value:n,onChange:(e,t)=>o(t),textColor:"inherit",TabIndicatorProps:{style:{backgroundColor:"white",border:"2px dashed",borderRadius:5}},children:[(0,a.jsx)(i.Z,{label:"Lịch sử",...V(0)}),(0,a.jsx)(i.Z,{label:"Danh s\xe1ch y\xeau th\xedch",...V(1)}),(0,a.jsx)(i.Z,{label:"Danh s\xe1ch ph\xe1t",...V(2)}),(0,a.jsx)(i.Z,{label:"Tạo Group",...V(3),disabled:c}),(0,a.jsx)(i.Z,{label:"Danh s\xe1ch Group",...V(4),disabled:c})]}),(0,a.jsx)(Q,{value:n,index:0,children:(0,a.jsx)(j,{})}),(0,a.jsx)(Q,{value:n,index:1,children:"Danh s\xe1ch y\xeau th\xedch"}),(0,a.jsx)(Q,{value:n,index:2,children:(0,a.jsx)(f,{})}),(0,a.jsx)(Q,{value:n,index:3,children:(0,a.jsx)(G,{setTab:o})}),(0,a.jsx)(Q,{value:n,index:4,children:(0,a.jsx)(M,{})})]})}},81835:function(e,t,n){"use strict";n.d(t,{w:function(){return a}});let a=async e=>{let{url:t,method:n,body:a,useCredentials:r=!1,headers:s={},nextOption:i={}}=e,l={method:n,headers:new Headers({"content-type":"application/json",...s}),body:a?JSON.stringify(a):null,...i};return r&&(l.credentials="include"),fetch(t,l).then(e=>e.ok?e.json():e.json().then(function(t){var n,a;return{statusCode:e.status,message:null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"",error:null!==(a=null==t?void 0:t.error)&&void 0!==a?a:""}}))}},81735:function(e,t,n){"use strict";n.d(t,{IS:function(){return i},Zd:function(){return a}});let a=e=>e.some(e=>"687bc3702806ef7792a8eba2"===e||"687e71714a591f0af8895298"===e||"687e71794a591f0af889529e"===e),r=e=>e.user.some(t=>t._id===e.propUserID),s=e=>{let{songID:t,shared:n}=e;return null==n?void 0:n.some(e=>e===t)},i=e=>{let{user:t,role:n,propUserID:i,songID:l,shared:o}=e,d=r({user:t,propUserID:i}),c=a(n),u=s({songID:l,shared:o});return!!d||!!c||!!u}}},function(e){e.O(0,[0,52,256,709,139,690,61,305,975,858,342,870,489,915,192,971,596,744],function(){return e(e.s=53473)}),_N_E=e.O()}]);